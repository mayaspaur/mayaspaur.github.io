---
title: "dashboard"
output: 
  flexdashboard::flex_dashboard:
    orientation: columns
    vertical_layout: fill
---


### Introduction

The following data was sourced from the New York City Department of Health and Mental Hygiene (DOHMH) New York City Restaurant Inspection Results database, and obtained from the p8105.datasets package. The DOHMH annually inspects NYC restaurants to assess restaurant compliance with food handling, food temperature, worker personal hygiene, and vermin control regulations. Each regulation violation is assigned a number of points that are summed into a score at the end of the investigation. Scores are used to inform an overall grade; a lower score (fewer regulation violations) rececives a higher grade, with A being the highest grade.

Key variables in this dataset that are explored visually on this page include score, grade, and boro (which indicates which NYC borough the restaurant was located in). Inspection_date reports the date of the inspection; the year was isolated from the inspection_date and was also used to visualize the data below.

-----------------------------------------------------------------------

### _Loading the data_

```{r setup}
library(flexdashboard)
library(tidyverse)
library(viridis)
library(p8105.datasets)
library(plotly)

```


-----------------------------------------------------------------------

### _Cleaning the data_

```{r}
rest_inspec = 
  rest_inspec %>%
  janitor::clean_names() %>%
  filter(grade %in% c("A", "B", "C"), boro != "Missing") %>% 
  mutate(boro = str_to_title(boro)) %>%
  mutate(boro = as.factor(boro),
         critical_flag = as.ordered(critical_flag))

```



### Chart A

This is a bar graph displaying the total number of restaurant inspections conducted in each borough. 

```{r}
bar_graph =
rest_inspec %>% 
  count(boro) %>% 
  mutate(boro = fct_reorder(boro, n)) %>% 
  plot_ly(x = ~boro, y = ~n, color = ~boro, type = "bar")

bar_graph

```



### Chart B

This is a bar graph depicting the number of restaurant inspections that received a grade of A in each borough.

```{r}
bar_graph_A =
  rest_inspec %>% 
  filter(grade == "A") %>%
  count(boro) %>% 
  mutate(boro = fct_reorder(boro, n)) %>% 
  plot_ly(x = ~boro, y = ~n, color = ~boro, type = "bar")

bar_graph_A

```



### Chart C

This is a boxplot featuring the distribution of scores from the restaurant inspections for each borough.

```{r}
boxplot = 
  rest_inspec %>%
  mutate(boro = fct_reorder(boro, score)) %>% 
  plot_ly(y = ~score, color = ~boro, type = "box",
          colors = "Set2")


```



### Chart D

This is a scatter plot featuring the year and mean score of restaurant inspections that received a grade of A in Manhattan and Brooklyn after 2000.

```{r}
scatter_plot =
  rest_inspec %>%
  mutate(year = lubridate::year(inspection_date)) %>%
  filter(year >= "2000", boro == "Brooklyn" | boro == "Manhattan") %>%
  group_by(boro, year) %>%
  mutate(mean_score = mean(score)) %>%
  plot_ly(
    x = ~year, y = ~mean_score, type = "scatter", mode = "markers",
    color = ~boro, alpha = 0.5, colors = "Set2")

scatter_plot


```









